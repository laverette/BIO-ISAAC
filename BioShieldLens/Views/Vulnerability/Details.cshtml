@model Vulnerability
@{
    ViewData["Title"] = $"Vulnerability Details - {Model.CveId}";
}

<div class="row mt-4">
    <div class="col-12">
        <h2>@Model.CveId</h2>
        <a asp-action="Index" class="btn btn-outline-secondary">‚Üê Back to List</a>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5>Description</h5>
            </div>
            <div class="card-body">
                <p>@Model.Description</p>
            </div>
        </div>

        @if (!string.IsNullOrEmpty(Model.IntelNotes))
        {
            <div class="card mt-3 border-primary">
                <div class="card-header bg-primary text-white">
                    <h5><i class="bi bi-lightbulb"></i> Intelligence Notes</h5>
                </div>
                <div class="card-body">
                    <p>@Model.IntelNotes</p>
                </div>
            </div>
        }
    </div>

    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5>Details</h5>
            </div>
            <div class="card-body">
                <table class="table table-sm">
                    <tr>
                        <th>Source:</th>
                        <td>@(Model.Source ?? "Unknown")</td>
                    </tr>
                    <tr>
                        <th>Severity Score:</th>
                        <td>
                            @if (Model.SeverityScore.HasValue)
                            {
                                <span class="badge bg-warning">@Model.SeverityScore.Value.ToString("F1")</span>
                            }
                            else
                            {
                                <span class="text-muted">N/A</span>
                            }
                        </td>
                    </tr>
                    <tr>
                        <th>Bio Impact:</th>
                        <td>
                            @if (Model.BioImpactScore.HasValue)
                            {
                                <span class="badge bg-primary">@Model.BioImpactScore.Value.ToString("F1")</span>
                            }
                            else
                            {
                                <span class="text-muted">N/A</span>
                            }
                        </td>
                    </tr>
                    <tr>
                        <th>Human Impact:</th>
                        <td>
                            @if (Model.HumanImpactScore.HasValue)
                            {
                                <span class="badge bg-danger">@Model.HumanImpactScore.Value.ToString("F1")</span>
                            }
                            else
                            {
                                <span class="text-muted">N/A</span>
                            }
                        </td>
                    </tr>
                    <tr>
                        <th>Urgency Level:</th>
                        <td>
                            @if (!string.IsNullOrEmpty(Model.UrgencyLevel))
                            {
                                var badgeClass = Model.UrgencyLevel == "Critical to Act Now" ? "bg-danger" :
                                                Model.UrgencyLevel == "Monitor" ? "bg-warning" : "bg-info";
                                <span class="badge @badgeClass">@Model.UrgencyLevel</span>
                            }
                            else
                            {
                                <span class="text-muted">Not classified</span>
                            }
                        </td>
                    </tr>
                    <tr>
                        <th>Affected Sector:</th>
                        <td>@(Model.AffectedSector ?? "Unknown")</td>
                    </tr>
                    <tr>
                        <th>Date Discovered:</th>
                        <td>@(Model.DateDiscovered?.ToString("yyyy-MM-dd HH:mm") ?? "N/A")</td>
                    </tr>
                </table>

                <form asp-action="Reclassify" method="post" class="mt-3">
                    <input type="hidden" name="id" value="@Model.Id" />
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="bi bi-arrow-clockwise"></i> Reclassify with AI
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

